<%# app/views/journeys/show.html.erb %>
<div id="show">
  <div class='container d-flex justify-content-center align-items-center'>
    <div class='row'>
      <div class='col'>
        <div class="dashboard">
          <!-- Bouton de retour -->
          <div class="back-button">
            <%= link_to "←", home_path, class: "back-link" %>
          </div>
          <!-- Titre principal -->
          <h1>Ton programme <span class="highlight">personnalisé</span></h1>
          <p>Voici ton point de départ pour surmonter la peur de l’avion :</p>
          <!-- Barre de progression -->
          <div class="progress" style="height: 20px;">
            <div
              class="progress-bar bg-success"
              role="progressbar"
              style="width: <%= @progress %>%;"
              aria-valuenow="<%= @progress %>"
              aria-valuemin="0"
              aria-valuemax="100">
              <%= @progress %>%
            </div>
          </div>
          <!-- Liste des contenus -->
          <% @journey_documents.each do |j_document| %>
            <% document = j_document.document %>
            <div class="content-item d-flex justify-content-between align-items-center">
              <% case document.kind %>
              <% when "article" %>
                <h3><%= link_to document.title, journeys_document_path(j_document), class: "article-title-link" %></h3>
              <% when "video" %>
                <h3><%= link_to document.title, video_journeys_document_path(j_document), class: "btn btn-link" %></h3>
                <%= link_to video_journeys_document_path(j_document), class: "stretched-link" do %>
                  <div class="video-preview">
                    <video controls>
                      <source src="<%= document.url %>" type="video/mp4">
                      Votre navigateur ne supporte pas la lecture des vidéos.
                    </video>
                  </div>
                <% end %>
              <% when "audio" %>
                <h3><%= link_to document.title, journeys_document_path(j_document), class: "audio-title-link" %></h3>
                <div class="audio">
                  <audio controls>
                    <source src="<%= document.url %>" type="audio/mpeg">
                    Votre navigateur ne supporte pas la lecture des audios.
                  </audio>
                </div>
              <% else %>
                <p>Type de contenu non pris en charge.</p>
              <% end %>
            </div>

            <!-- Icône de cœur pour favoris - Placé en dehors de content-item -->
            <div class="favorite-icon-container" data-document-id="<%= document.id %>">
              <% if current_user.favorite_documents.include?(document) %>
                <img src="<%= asset_path('icons/heart-filled.png') %>" alt="Heart Filled" class="heart-filled">
                <img src="<%= asset_path('icons/heart-open.png') %>" alt="Heart Open" class="heart-open hidden">
              <% else %>
                <img src="<%= asset_path('icons/heart-filled.png') %>" alt="Heart Filled" class="heart-filled hidden">
                <img src="<%= asset_path('icons/heart-open.png') %>" alt="Heart Open" class="heart-open">
              <% end %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
